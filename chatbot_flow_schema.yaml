name: "Jul.IA - Assistente de WhatsApp"
version: "1.0.0"
description: "Chatbot para qualificaÃ§Ã£o de leads em revisÃ£o de emprÃ©stimos bancÃ¡rios"

# ============================================
# CONFIGURAÃ‡Ã•ES GERAIS
# ============================================
settings:
  language: "pt-BR"
  tone: "profissional, acessÃ­vel, sem jargÃ£o excessivo"
  specialty: "Direito do Consumidor - RevisÃ£o de EmprÃ©stimos BancÃ¡rios"
  response_time: "imediato"
  business_hours: "24/7 (bot) + horÃ¡rio comercial (humano)"
  
# ============================================
# FLUXO CONVERSACIONAL
# ============================================
conversation_flow:
  
  # ETAPA 1: BOAS-VINDAS E APRESENTAÃ‡ÃƒO
  - step: "welcome"
    id: "001"
    trigger: "primeira mensagem do usuÃ¡rio"
    messages:
      - text: |
          OlÃ¡! ðŸ‘‹ Seja bem-vindo(a)!
          
          Sou a **Jul.IA**, assistente virtual do escritÃ³rio de advocacia especializado em **Direito do Consumidor** e **RevisÃ£o de EmprÃ©stimos BancÃ¡rios**.
          
          Estou aqui para ajudar vocÃª a entender se tem direito a revisar seu emprÃ©stimo e recuperar valores pagos indevidamente. 
          
          Posso fazer algumas perguntas para entender melhor sua situaÃ§Ã£o?
    buttons:
      - id: "sim_continuar"
        label: "Sim, vamos lÃ¡!"
      - id: "nao_agora"
        label: "NÃ£o, obrigado"
      - id: "falar_humano"
        label: "Falar com advogado"
    next_step:
      sim_continuar: "002"
      nao_agora: "099"
      falar_humano: "098"
  
  # ETAPA 2: IDENTIFICAÃ‡ÃƒO DO USUÃRIO - NOME
  - step: "get_name"
    id: "002"
    messages:
      - text: "Perfeito! Para comeÃ§ar, qual Ã© o seu **nome completo**?"
    input_type: "text"
    validation: "nome_completo"
    save_to: "cliente_nome"
    next_step: "003"
  
  # ETAPA 3: IDENTIFICAÃ‡ÃƒO - EMAIL
  - step: "get_email"
    id: "003"
    messages:
      - text: "Obrigada, {{cliente_nome}}! ðŸ˜Š\n\nAgora, qual Ã© o seu **e-mail**?"
    input_type: "text"
    validation: "email"
    save_to: "cliente_email"
    next_step: "004"
  
  # ETAPA 4: IDENTIFICAÃ‡ÃƒO - WHATSAPP
  - step: "get_whatsapp"
    id: "004"
    messages:
      - text: "Ã“timo! Confirme seu nÃºmero de **WhatsApp** para contato:\n\nÃ‰ este nÃºmero: {{phone_number}}?"
    buttons:
      - id: "sim_whatsapp"
        label: "Sim, estÃ¡ correto"
      - id: "nao_whatsapp"
        label: "NÃ£o, outro nÃºmero"
    next_step:
      sim_whatsapp: "005"
      nao_whatsapp: "004a"
  
  - step: "get_whatsapp_manual"
    id: "004a"
    messages:
      - text: "Por favor, digite o nÃºmero de WhatsApp correto (com DDD):"
    input_type: "text"
    validation: "telefone"
    save_to: "cliente_whatsapp"
    next_step: "005"
  
  # ETAPA 5: TIPO DE EMPRÃ‰STIMO
  - step: "loan_type"
    id: "005"
    messages:
      - text: |
          Agora vamos falar sobre seu emprÃ©stimo. ðŸ’°
          
          VocÃª possui ou possuiu algum **emprÃ©stimo consignado**?
          
          _(EmprÃ©stimo consignado Ã© aquele descontado diretamente da folha de pagamento ou benefÃ­cio do INSS)_
    buttons:
      - id: "sim_consignado"
        label: "Sim, consignado"
      - id: "nao_consignado"
        label: "NÃ£o, outro tipo"
      - id: "nao_sei"
        label: "NÃ£o sei"
    next_step:
      sim_consignado: "006"
      nao_consignado: "020"
      nao_sei: "005a"
  
  - step: "explain_consignado"
    id: "005a"
    messages:
      - text: |
          Sem problemas! Vou explicar:
          
          **EmprÃ©stimo Consignado** Ã© aquele em que as parcelas sÃ£o descontadas **automaticamente** do seu salÃ¡rio, aposentadoria ou benefÃ­cio do INSS.
          
          VocÃª se lembra se as parcelas eram descontadas direto da sua folha de pagamento?
    buttons:
      - id: "sim_desconto_folha"
        label: "Sim, era descontado"
      - id: "nao_desconto_folha"
        label: "NÃ£o, eu pagava"
      - id: "ainda_nao_sei"
        label: "Ainda nÃ£o sei"
    next_step:
      sim_desconto_folha: "006"
      nao_desconto_folha: "020"
      ainda_nao_sei: "098"
  
  # ETAPA 6: STATUS DO EMPRÃ‰STIMO CONSIGNADO
  - step: "loan_status"
    id: "006"
    messages:
      - text: "Entendi! E esse emprÃ©stimo consignado estÃ¡:"
    buttons:
      - id: "ativo"
        label: "Ativo (ainda pagando)"
      - id: "encerrado"
        label: "Encerrado (jÃ¡ paguei tudo)"
      - id: "refinanciado"
        label: "Refinanciado (mata-mata)"
    next_step:
      ativo: "007"
      encerrado: "007"
      refinanciado: "007"
  
  # ETAPA 7: BANCO DO EMPRÃ‰STIMO
  - step: "bank_name"
    id: "007"
    messages:
      - text: "Qual Ã© o **banco** do seu emprÃ©stimo consignado?"
    input_type: "text"
    validation: "texto"
    save_to: "banco_nome"
    next_step: "008"
  
  # ETAPA 8: VALOR DAS PARCELAS
  - step: "installment_value"
    id: "008"
    messages:
      - text: "Qual Ã© o **valor aproximado das parcelas** que vocÃª paga/pagava?"
    input_type: "text"
    validation: "valor_monetario"
    save_to: "valor_parcela"
    next_step: "009"
  
  # ETAPA 9: NÃšMERO DE PARCELAS
  - step: "installment_count"
    id: "009"
    messages:
      - text: "Quantas **parcelas** ao todo vocÃª contratou?"
    input_type: "text"
    validation: "numero"
    save_to: "numero_parcelas"
    next_step: "010"
  
  # ETAPA 10: PERÃODO DO CONTRATO
  - step: "contract_period"
    id: "010"
    messages:
      - text: "Quando vocÃª **contratou** esse emprÃ©stimo? (mÃªs e ano aproximados)"
    input_type: "text"
    validation: "data_aproximada"
    save_to: "periodo_contrato"
    next_step: "011"
  
  # ETAPA 11: NÃšMERO DO CONTRATO
  - step: "contract_number"
    id: "011"
    messages:
      - text: |
          VocÃª tem em mÃ£os o **nÃºmero do contrato** ou algum documento do emprÃ©stimo?
          
          Se tiver, pode me enviar o nÃºmero ou uma foto do documento. Se nÃ£o tiver, sem problemas!
    buttons:
      - id: "tenho_contrato"
        label: "Tenho o nÃºmero"
      - id: "nao_tenho"
        label: "NÃ£o tenho agora"
    next_step:
      tenho_contrato: "011a"
      nao_tenho: "012"
  
  - step: "save_contract_number"
    id: "011a"
    messages:
      - text: "Ã“timo! Por favor, envie o **nÃºmero do contrato** ou uma **foto do documento**:"
    input_type: "text_or_image"
    save_to: "numero_contrato"
    next_step: "012"
  
  # ETAPA 12: ANÃLISE E QUALIFICAÃ‡ÃƒO
  - step: "qualification_analysis"
    id: "012"
    messages:
      - text: |
          Perfeito, {{cliente_nome}}! ðŸ“‹
          
          Estou analisando as informaÃ§Ãµes que vocÃª me passou...
          
          _(processando)_
    action: "analyze_qualification"
    next_step: "013"
  
  # ETAPA 13: RESULTADO POSITIVO - CASO QUALIFICADO
  - step: "qualified_positive"
    id: "013"
    condition: "caso_qualificado == true"
    messages:
      - text: |
          âœ… **Ã“tima notÃ­cia!**
          
          Com base nas informaÃ§Ãµes fornecidas, identificamos que vocÃª **pode ter direito** Ã  revisÃ£o do seu emprÃ©stimo consignado!
          
          Muitos clientes conseguem:
          â€¢ Reduzir o valor das parcelas
          â€¢ Recuperar valores pagos indevidamente
          â€¢ Cancelar juros abusivos
          â€¢ Obter devoluÃ§Ã£o de taxas indevidas
          
          **O que vocÃª gostaria de fazer agora?**
    buttons:
      - id: "agendar_atendimento"
        label: "Agendar atendimento"
      - id: "enviar_documentos"
        label: "Enviar documentos agora"
      - id: "mais_informacoes"
        label: "Quero mais informaÃ§Ãµes"
    next_step:
      agendar_atendimento: "014"
      enviar_documentos: "015"
      mais_informacoes: "016"
  
  # ETAPA 14: AGENDAMENTO DE ATENDIMENTO
  - step: "schedule_appointment"
    id: "014"
    messages:
      - text: |
          Perfeito! Vou agendar um atendimento com nosso advogado especializado. ðŸ“…
          
          Qual **dia e horÃ¡rio** seria melhor para vocÃª?
          
          Nosso horÃ¡rio de atendimento Ã© de segunda a sexta, das 9h Ã s 18h.
    input_type: "text"
    save_to: "preferencia_agendamento"
    action: "create_appointment_request"
    next_step: "014a"
  
  - step: "appointment_confirmation"
    id: "014a"
    messages:
      - text: |
          âœ… **Agendamento registrado!**
          
          Nosso advogado entrarÃ¡ em contato com vocÃª em breve para confirmar o horÃ¡rio.
          
          Enquanto isso, vocÃª pode jÃ¡ ir **separando os documentos** do seu emprÃ©stimo (contrato, extratos, comprovantes de pagamento).
          
          VocÃª tambÃ©m receberÃ¡ um link para preencher uma ficha mais detalhada. Tudo bem?
    buttons:
      - id: "ok_aguardar"
        label: "Ok, vou aguardar"
      - id: "enviar_docs_agora"
        label: "Enviar documentos agora"
    next_step:
      ok_aguardar: "097"
      enviar_docs_agora: "015"
  
  # ETAPA 15: ENVIO DE DOCUMENTOS E PROCURAÃ‡ÃƒO
  - step: "send_documents"
    id: "015"
    messages:
      - text: |
          Excelente! Para agilizar seu atendimento, vou enviar um **link** onde vocÃª pode:
          
          âœ… Preencher seus dados completos
          âœ… Fazer upload dos documentos do emprÃ©stimo
          âœ… Assinar a procuraÃ§Ã£o digitalmente (via ZapSign)
          
          Tudo de forma **rÃ¡pida, segura e online**!
          
          Vou enviar o link agora. Ok?
    buttons:
      - id: "sim_enviar_link"
        label: "Sim, pode enviar!"
    action: "generate_client_form_link"
    next_step: "015a"
  
  - step: "send_form_link"
    id: "015a"
    messages:
      - text: |
          ðŸ“Ž **Link do formulÃ¡rio:**
          {{form_link}}
          
          Preencha com calma e, se tiver dÃºvidas, Ã© sÃ³ me chamar!
          
          ApÃ³s preencher, vocÃª receberÃ¡ a procuraÃ§Ã£o para assinar digitalmente pelo ZapSign.
          
          âš ï¸ **Importante:** Ao preencher o formulÃ¡rio e assinar a procuraÃ§Ã£o, vocÃª autoriza nosso escritÃ³rio a analisar seu contrato bancÃ¡rio e representÃ¡-lo judicialmente, se necessÃ¡rio.
    action: "send_form_link_whatsapp"
    next_step: "097"
  
  # ETAPA 16: MAIS INFORMAÃ‡Ã•ES SOBRE O SERVIÃ‡O
  - step: "more_info"
    id: "016"
    messages:
      - text: |
          Claro! Vou explicar melhor sobre nosso serviÃ§o de **RevisÃ£o de EmprÃ©stimos Consignados**:
          
          **O que Ã©?**
          Ã‰ a anÃ¡lise do seu contrato de emprÃ©stimo para identificar cobranÃ§as indevidas, juros abusivos, taxas ilegais e outras irregularidades.
          
          **Quando Ã© cabÃ­vel?**
          â€¢ EmprÃ©stimos consignados com juros acima do permitido
          â€¢ CobranÃ§as de taxas nÃ£o autorizadas
          â€¢ Refinanciamentos ("mata-mata") sem seu consentimento
          â€¢ Descontos indevidos na folha de pagamento
          
          **O que vocÃª precisa?**
          â€¢ Contrato do emprÃ©stimo
          â€¢ Extratos bancÃ¡rios
          â€¢ Comprovantes de pagamento
          â€¢ Documento de identidade e CPF
          
          **Quanto custa?**
          Trabalhamos com **honorÃ¡rios de Ãªxito**: vocÃª sÃ³ paga se ganharmos a causa! 
          
          Nosso percentual Ã© acordado no contrato de honorÃ¡rios.
          
          **Quanto tempo demora?**
          A anÃ¡lise inicial leva de 3 a 5 dias Ãºteis. O processo judicial pode levar de 6 meses a 2 anos, dependendo do caso.
          
          Ficou mais claro? O que vocÃª gostaria de fazer agora?
    buttons:
      - id: "agendar_pos_info"
        label: "Agendar atendimento"
      - id: "enviar_docs_pos_info"
        label: "Enviar documentos"
      - id: "falar_advogado_pos_info"
        label: "Falar com advogado"
    next_step:
      agendar_pos_info: "014"
      enviar_docs_pos_info: "015"
      falar_advogado_pos_info: "098"
  
  # ETAPA 20: EMPRÃ‰STIMO NÃƒO CONSIGNADO
  - step: "non_consigned_loan"
    id: "020"
    messages:
      - text: |
          Entendi! VocÃª mencionou que seu emprÃ©stimo **nÃ£o Ã© consignado**.
          
          Nosso escritÃ³rio Ã© especializado principalmente em **emprÃ©stimos consignados**, mas tambÃ©m atendemos outros casos de direito do consumidor.
          
          Qual tipo de emprÃ©stimo ou problema vocÃª tem?
    input_type: "text"
    save_to: "tipo_problema"
    next_step: "021"
  
  - step: "analyze_other_case"
    id: "021"
    messages:
      - text: |
          Obrigada pelas informaÃ§Ãµes, {{cliente_nome}}!
          
          Vou encaminhar seu caso para um de nossos advogados analisar se podemos ajudar.
          
          Um advogado entrarÃ¡ em contato com vocÃª em breve pelo WhatsApp ou e-mail.
          
          Enquanto isso, se tiver documentos relacionados ao seu caso, pode jÃ¡ ir separando!
    action: "forward_to_human_specialist"
    next_step: "097"
  
  # ETAPA 97: FINALIZAÃ‡ÃƒO COM SUCESSO
  - step: "success_end"
    id: "097"
    messages:
      - text: |
          ðŸŽ‰ **Tudo certo!**
          
          Suas informaÃ§Ãµes foram registradas e em breve vocÃª terÃ¡ retorno da nossa equipe.
          
          Se precisar de algo, Ã© sÃ³ me chamar novamente!
          
          **EscritÃ³rio de Advocacia - Direito do Consumidor**
          ðŸ“§ juliano@garbuggio.com.br
          ðŸ“± WhatsApp: (nÃºmero do escritÃ³rio)
          
          Tenha um Ã³timo dia! ðŸ˜Š
    action: "save_lead_success"
    end_conversation: true
  
  # ETAPA 98: ENCAMINHAR PARA ATENDIMENTO HUMANO
  - step: "forward_to_human"
    id: "098"
    messages:
      - text: |
          Sem problemas! Vou encaminhar vocÃª para um **atendimento humano** com nosso advogado ou assistente.
          
          Aguarde um momento, alguÃ©m da equipe entrarÃ¡ em contato com vocÃª em breve!
          
          ðŸ“± Se preferir, vocÃª tambÃ©m pode ligar diretamente para nosso escritÃ³rio.
    action: "notify_human_agent"
    save_to: "atendimento_humano_solicitado"
    next_step: "097"
  
  # ETAPA 99: USUÃRIO NÃƒO QUER CONTINUAR
  - step: "user_declined"
    id: "099"
    messages:
      - text: |
          Sem problemas! Entendo perfeitamente.
          
          Se mudar de ideia ou tiver dÃºvidas sobre **revisÃ£o de emprÃ©stimos** ou **direito do consumidor**, Ã© sÃ³ me chamar novamente!
          
          Estou sempre por aqui. ðŸ˜Š
          
          Tenha um Ã³timo dia!
    action: "save_lead_declined"
    end_conversation: true

# ============================================
# CONSENTIMENTOS E LGPD
# ============================================
consent_messages:
  lgpd_initial:
    text: |
      âš ï¸ **ProteÃ§Ã£o de Dados Pessoais (LGPD)**
      
      Ao continuar esta conversa e fornecer seus dados, vocÃª autoriza o escritÃ³rio de advocacia a coletar, armazenar e processar suas informaÃ§Ãµes pessoais exclusivamente para:
      
      âœ… AnÃ¡lise de viabilidade do seu caso
      âœ… ComunicaÃ§Ã£o sobre serviÃ§os jurÃ­dicos
      âœ… ElaboraÃ§Ã£o de documentos e procuraÃ§Ãµes
      âœ… RepresentaÃ§Ã£o jurÃ­dica, se contratado
      
      Seus dados serÃ£o tratados com total confidencialidade e seguranÃ§a, conforme a Lei Geral de ProteÃ§Ã£o de Dados (LGPD - Lei 13.709/2018).
      
      VocÃª concorda com estes termos?
    buttons:
      - id: "aceito_lgpd"
        label: "Sim, concordo"
      - id: "nao_aceito_lgpd"
        label: "NÃ£o concordo"
  
  contract_analysis_consent:
    text: |
      ðŸ“„ **AutorizaÃ§Ã£o para AnÃ¡lise de Contrato BancÃ¡rio**
      
      Para prosseguir com a anÃ¡lise do seu emprÃ©stimo, preciso da sua autorizaÃ§Ã£o para:
      
      âœ… Analisar seu contrato bancÃ¡rio
      âœ… Solicitar documentos e extratos
      âœ… Verificar cobranÃ§as e taxas
      âœ… Identificar possÃ­veis irregularidades
      
      VocÃª autoriza a anÃ¡lise do seu contrato bancÃ¡rio?
    buttons:
      - id: "autorizo_analise"
        label: "Sim, autorizo"
      - id: "nao_autorizo"
        label: "NÃ£o autorizo"

# ============================================
# MAPEAMENTO DE DADOS CAPTURADOS
# ============================================
data_schema:
  lead:
    cliente_nome: "string"
    cliente_email: "string"
    cliente_whatsapp: "string"
    banco_nome: "string"
    tipo_emprestimo: "string" # consignado, pessoal, cartao, etc
    status_emprestimo: "string" # ativo, encerrado, refinanciado
    valor_parcela: "decimal"
    numero_parcelas: "integer"
    periodo_contrato: "string"
    numero_contrato: "string"
    tipo_problema: "string"
    caso_qualificado: "boolean"
    atendimento_humano_solicitado: "boolean"
    preferencia_agendamento: "string"
    consentimento_lgpd: "boolean"
    consentimento_analise_contrato: "boolean"
    data_primeiro_contato: "datetime"
    data_ultima_interacao: "datetime"
    status_lead: "string" # novo, qualificado, agendado, documentos_enviados, convertido, perdido
    origem: "string" # whatsapp_bot
    
# ============================================
# REGRAS DE QUALIFICAÃ‡ÃƒO
# ============================================
qualification_rules:
  positive_criteria:
    - tipo_emprestimo: "consignado"
    - status_emprestimo: ["ativo", "encerrado", "refinanciado"]
    - valor_parcela: "> 0"
    - numero_parcelas: "> 0"
  
  negative_criteria:
    - tipo_emprestimo: "nao_consignado"
    - informacoes_insuficientes: true
  
  forward_to_human:
    - caso_complexo: true
    - duvidas_persistentes: true
    - solicitacao_explicita: true
    - fora_do_escopo: true

# ============================================
# INTEGRAÃ‡Ã•ES
# ============================================
integrations:
  zapi:
    send_message: "POST /send-text"
    send_button: "POST /send-button"
    send_document: "POST /send-document"
    webhook: "POST /api/webhooks/zapi"
  
  zapsign:
    create_document: "POST /api/v1/documents"
    send_for_signature: "POST /api/v1/documents/{id}/send"
    webhook: "POST /api/webhooks/zapsign"
  
  julia_procuracoes:
    import_client: "POST /api/integration/import-client"
    export_client: "POST /api/integration/export-client"
  
  julia_peticoes:
    import_client: "POST /api/integration/import-client"
  
  julia_agenda:
    create_appointment: "POST /api/appointments"
    notify_team: "POST /api/notifications"

# ============================================
# RELATÃ“RIOS E MÃ‰TRICAS
# ============================================
reports:
  leads_qualified:
    description: "NÃºmero de leads qualificados por perÃ­odo"
    fields: ["data", "total_leads", "leads_qualificados", "taxa_qualificacao"]
  
  human_handoff:
    description: "Casos encaminhados para atendimento humano"
    fields: ["data", "total_encaminhamentos", "motivo", "status_atendimento"]
  
  conversion_funnel:
    description: "Funil de conversÃ£o do chatbot"
    stages:
      - "iniciou_conversa"
      - "forneceu_dados_pessoais"
      - "qualificado_positivo"
      - "agendou_atendimento"
      - "enviou_documentos"
      - "assinou_procuracao"
      - "convertido_cliente"
  
  export_formats:
    - "CSV"
    - "JSON"
    - "Excel"
